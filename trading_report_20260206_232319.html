<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyperliquid äº¤æ˜“åœ°å€åˆ†ææŠ¥å‘Š</title>
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --border-color: #30363d;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-cyan: #58a6ff;
            --accent-green: #3fb950;
            --accent-red: #f85149;
            --accent-yellow: #d29922;
            --accent-purple: #a371f7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            padding: 20px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2rem;
            color: var(--accent-cyan);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .header .subtitle {
            color: var(--text-secondary);
            margin-top: 8px;
            font-size: 0.9rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }

        .stat-card .label {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-bottom: 4px;
        }

        .stat-card .value {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .stat-card .value.positive {
            color: var(--accent-green);
        }

        .stat-card .value.negative {
            color: var(--accent-red);
        }

        .table-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .table-header h2 {
            font-size: 1.1rem;
            color: var(--text-primary);
        }

        .table-controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .search-input {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px 12px;
            color: var(--text-primary);
            font-size: 0.9rem;
            width: 250px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        .table-wrapper {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        th {
            background: var(--bg-tertiary);
            color: var(--accent-cyan);
            font-weight: 600;
            text-align: left;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        th:hover {
            background: var(--bg-primary);
        }

        th .sort-icon {
            margin-left: 4px;
            opacity: 0.3;
        }

        th.sort-asc .sort-icon,
        th.sort-desc .sort-icon {
            opacity: 1;
        }

        th.sort-asc .sort-icon::after {
            content: 'â–²';
        }

        th.sort-desc .sort-icon::after {
            content: 'â–¼';
        }

        th:not(.sort-asc):not(.sort-desc) .sort-icon::after {
            content: 'â‡…';
        }

        td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
        }

        tr:hover {
            background: var(--bg-tertiary);
        }

        .rank {
            color: var(--text-muted);
            font-weight: 500;
        }

        .address {
            font-family: 'SF Mono', Monaco, 'Andale Mono', monospace;
            color: var(--accent-purple);
            font-size: 0.85rem;
        }

        .positive {
            color: var(--accent-green);
        }

        .negative {
            color: var(--accent-red);
        }

        .neutral {
            color: var(--text-secondary);
        }

        .highlight {
            font-weight: 600;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 30px;
            border-top: 1px solid var(--border-color);
        }

        .column-toggle {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px 16px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.85rem;
        }

        .column-toggle:hover {
            background: var(--bg-primary);
        }

        .column-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            z-index: 100;
            display: none;
            min-width: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .column-menu.show {
            display: block;
        }

        .column-menu label {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 0;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .column-menu label:hover {
            color: var(--accent-cyan);
        }

        .column-menu-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .column-menu-btn {
            flex: 1;
            padding: 6px 12px;
            font-size: 0.8rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .column-menu-btn:hover {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            border-color: var(--accent-cyan);
        }

        /* ç­›é€‰å™¨æ ·å¼ */
        .filter-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .filter-header h3 {
            font-size: 1rem;
            color: var(--text-primary);
            margin: 0;
        }

        .filter-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .filter-row {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-select, .filter-input {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px 12px;
            color: var(--text-primary);
            font-size: 0.85rem;
        }

        .filter-select {
            min-width: 140px;
        }

        .filter-input {
            width: 100px;
        }

        .filter-select:focus, .filter-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        .filter-btn {
            padding: 8px 16px;
            font-size: 0.85rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-btn-add {
            background: var(--accent-cyan);
            color: var(--bg-primary);
            border-color: var(--accent-cyan);
        }

        .filter-btn-add:hover {
            background: #4090e0;
        }

        .filter-btn-remove {
            background: var(--bg-tertiary);
            color: var(--accent-red);
            border-color: var(--accent-red);
            padding: 8px 12px;
        }

        .filter-btn-remove:hover {
            background: var(--accent-red);
            color: white;
        }

        .filter-btn-clear {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }

        .filter-btn-clear:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .filter-actions {
            display: flex;
            gap: 10px;
            margin-top: 12px;
        }

        .filter-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: var(--bg-tertiary);
            border: 1px solid var(--accent-cyan);
            border-radius: 20px;
            padding: 4px 12px;
            font-size: 0.8rem;
            color: var(--accent-cyan);
        }

        .filter-badge-remove {
            cursor: pointer;
            color: var(--accent-red);
            font-weight: bold;
        }

        .active-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .filter-result-count {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .table-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .search-input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” Hyperliquid äº¤æ˜“åœ°å€åˆ†ææŠ¥å‘Š</h1>
            <p class="subtitle">ç”Ÿæˆæ—¶é—´: 2026-02-06 23:23:19 | æ•°æ®æ¥æº: Hyperliquid API</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="label">åˆ†æåœ°å€æ•°</div>
                <div class="value">1 / 1</div>
            </div>
            <div class="stat-card">
                <div class="label">å¹³å‡å¤æ™®æ¯”ç‡</div>
                <div class="value positive">26.42</div>
            </div>
            <div class="stat-card">
                <div class="label">å¹³å‡èƒœç‡</div>
                <div class="value">100.0%</div>
            </div>
            <div class="stat-card">
                <div class="label">æ€»ç´¯è®¡ç›ˆäº</div>
                <div class="value positive">$11.06</div>
            </div>
            <div class="stat-card">
                <div class="label">ç›ˆåˆ©åœ°å€æ•°</div>
                <div class="value positive">1 / 1</div>
            </div>
        </div>

        <div class="filter-container">
            <div class="filter-header">
                <h3>ğŸ”§ æŒ‡æ ‡ç­›é€‰</h3>
                <span class="filter-result-count" id="filterResultCount"></span>
            </div>
            <div class="filter-list" id="filterList">
                <!-- ç­›é€‰æ¡ä»¶å°†ç”± JS ç”Ÿæˆ -->
            </div>
            <div class="filter-actions">
                <button class="filter-btn filter-btn-add" id="addFilterBtn">+ æ·»åŠ ç­›é€‰æ¡ä»¶</button>
                <button class="filter-btn filter-btn-clear" id="clearFiltersBtn">æ¸…é™¤å…¨éƒ¨</button>
            </div>
            <div class="active-filters" id="activeFilters">
                <!-- æ´»åŠ¨ç­›é€‰æ ‡ç­¾å°†ç”± JS ç”Ÿæˆ -->
            </div>
        </div>

        <div class="table-container">
            <div class="table-header">
                <h2>ğŸ“Š è¯¦ç»†æ•°æ®è¡¨æ ¼</h2>
                <div class="table-controls">
                    <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢åœ°å€...">
                    <div style="position: relative;">
                        <button class="column-toggle" id="columnToggle">æ˜¾ç¤ºåˆ— â–¼</button>
                        <div class="column-menu" id="columnMenu">
                            <!-- åˆ—é€‰æ‹©å™¨å°†ç”± JS ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="table-wrapper">
                <table id="dataTable">
                    <thead>
                        <tr id="tableHeader">
                            <!-- è¡¨å¤´å°†ç”± JS ç”Ÿæˆ -->
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- æ•°æ®å°†ç”± JS ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="footer">
            <p>ğŸ“ˆ Apex Fork - äº¤æ˜“åˆ†æç³»ç»Ÿ | åŸºäº Hyperliquid å®˜æ–¹ API</p>
            <p>æ‰€æœ‰æŒ‡æ ‡åŸºäºå•ç¬”äº¤æ˜“æ”¶ç›Šç‡è®¡ç®—ï¼Œä¸ä¾èµ–æœ¬é‡‘æ•°æ®</p>
        </div>
    </div>

    <script>
        // è¡¨æ ¼æ•°æ®
        const tableData = [{"rank": 1, "address": "0xcc8e811404efeea2bfa2002db251ebabf43cb94a", "total_trades": 19, "win_rate": 100.0, "sharpe_ratio": 26.42313258224242, "profit_factor": 1000.0, "total_pnl": 11.058816, "total_realized_pnl": 11.058816, "total_unrealized_pnl": 0, "account_value": 621.0865590000001, "perp_account_value": 472.206559, "spot_account_value": 148.88, "total_margin_used": 0.0, "mean_return": 2.5538249910803783, "std_return": 1.5074175821044578, "min_return_7d": 0.02686727565824825, "trades_per_year": 243.3727912738445, "trading_days": 11.998054444444444, "bias": 5.2631578947368425, "long_positions": 0, "short_positions": 0, "total_positions": 0, "position_bias": "ä¸­æ€§", "total_position_value": 0, "avg_hold_time": 0.07932916221509971, "hold_time_today": 0, "hold_time_7d": 0.06641972222222223, "hold_time_30d": 0.07932916221509971, "roe_24h": 0.6748249351625369, "roe_7d": 17.779068114070014, "roe_30d": 25.080355238237257, "roe_all": 444.4187707849887}];

        // åˆ—å®šä¹‰
        const columns = [
            // åŸºç¡€ä¿¡æ¯
            { key: 'rank', label: '#', format: v => v, defaultVisible: true },
            { key: 'address', label: 'åœ°å€', format: v => v, defaultVisible: true, isAddress: true },
            // æ ¸å¿ƒäº¤æ˜“æŒ‡æ ‡
            { key: 'total_trades', label: 'äº¤æ˜“æ•°', format: v => v.toLocaleString(), defaultVisible: true },
            { key: 'win_rate', label: 'èƒœç‡', format: v => v.toFixed(1) + '%', defaultVisible: true },
            { key: 'sharpe_ratio', label: 'å¤æ™®æ¯”ç‡', format: v => v.toFixed(2), defaultVisible: true, colorByValue: true },
            { key: 'profit_factor', label: 'ç›ˆåˆ©å› å­', format: v => v >= 1000 ? 'âˆ' : v.toFixed(2), defaultVisible: true, colorByValue: true, threshold: 1 },
            // ç›ˆäºæŒ‡æ ‡
            { key: 'total_pnl', label: 'æ€»PNL', format: v => formatCurrency(v), defaultVisible: true, colorByValue: true, isCurrency: true },
            { key: 'total_realized_pnl', label: 'å·²å®ç°PNL', format: v => formatCurrency(v), defaultVisible: false, colorByValue: true, isCurrency: true },
            { key: 'total_unrealized_pnl', label: 'æœªå®ç°PNL', format: v => formatCurrency(v), defaultVisible: false, colorByValue: true, isCurrency: true },
            // è´¦æˆ·ä¿¡æ¯
            { key: 'account_value', label: 'è´¦æˆ·ä»·å€¼', format: v => formatCurrency(v), defaultVisible: true, isCurrency: true },
            { key: 'perp_account_value', label: 'Perpè´¦æˆ·', format: v => formatCurrency(v), defaultVisible: false, isCurrency: true },
            { key: 'spot_account_value', label: 'Spotè´¦æˆ·', format: v => formatCurrency(v), defaultVisible: false, isCurrency: true },
            { key: 'total_margin_used', label: 'ä¿è¯é‡‘ä½¿ç”¨', format: v => formatCurrency(v), defaultVisible: false, isCurrency: true },
            // æ”¶ç›Šç‡æŒ‡æ ‡
            { key: 'mean_return', label: 'å¹³å‡æ”¶ç›Šç‡', format: v => v.toFixed(2) + '%', defaultVisible: true, colorByValue: true },
            { key: 'std_return', label: 'æ”¶ç›Šç‡æ ‡å‡†å·®', format: v => v.toFixed(2) + '%', defaultVisible: false },
            { key: 'min_return_7d', label: '7å¤©æœ€å°æ”¶ç›Šç‡', format: v => v.toFixed(2) + '%', defaultVisible: false, colorByValue: true },
            { key: 'trades_per_year', label: 'å¹´äº¤æ˜“é¢‘ç‡', format: v => v.toFixed(0), defaultVisible: false },
            { key: 'trading_days', label: 'äº¤æ˜“å¤©æ•°', format: v => v.toFixed(1), defaultVisible: false },
            // æ–¹å‘åå¥½
            { key: 'bias', label: 'æ–¹å‘åå¥½%', format: v => v.toFixed(1) + '%', defaultVisible: false },
            { key: 'position_bias', label: 'ä»“ä½åå¥½', format: v => v, defaultVisible: false },
            { key: 'long_positions', label: 'å¤šå¤´æŒä»“', format: v => v, defaultVisible: false },
            { key: 'short_positions', label: 'ç©ºå¤´æŒä»“', format: v => v, defaultVisible: false },
            { key: 'total_positions', label: 'å½“å‰æŒä»“æ•°', format: v => v, defaultVisible: false },
            { key: 'total_position_value', label: 'æŒä»“æ€»ä»·å€¼', format: v => formatCurrency(v), defaultVisible: false, isCurrency: true },
            // æŒä»“æ—¶é—´
            { key: 'avg_hold_time', label: 'å†å²å¹³å‡æŒä»“æ—¶é—´', format: v => formatHoldTime(v), defaultVisible: true },
            { key: 'hold_time_today', label: 'ä»Šæ—¥å¹³å‡æŒä»“æ—¶é—´', format: v => formatHoldTime(v), defaultVisible: false },
            { key: 'hold_time_7d', label: '7å¤©å¹³å‡æŒä»“æ—¶é—´', format: v => formatHoldTime(v), defaultVisible: false },
            { key: 'hold_time_30d', label: '30å¤©å¹³å‡æŒä»“æ—¶é—´', format: v => formatHoldTime(v), defaultVisible: false },
            // ROE æŒ‡æ ‡
            { key: 'roe_24h', label: 'ROE(24h)', format: v => (v >= 0 ? '+' : '') + v.toFixed(2) + '%', defaultVisible: true, colorByValue: true },
            { key: 'roe_7d', label: 'ROE(7d)', format: v => (v >= 0 ? '+' : '') + v.toFixed(2) + '%', defaultVisible: false, colorByValue: true },
            { key: 'roe_30d', label: 'ROE(30d)', format: v => (v >= 0 ? '+' : '') + v.toFixed(2) + '%', defaultVisible: false, colorByValue: true },
            { key: 'roe_all', label: 'ROE(å†å²)', format: v => (v >= 0 ? '+' : '') + v.toFixed(2) + '%', defaultVisible: false, colorByValue: true },
        ];

        // å¯è§åˆ—
        let visibleColumns = columns.filter(c => c.defaultVisible).map(c => c.key);

        // å½“å‰æ’åº
        let currentSort = { key: 'rank', dir: 'asc' };

        // ç­›é€‰æ¡ä»¶
        let filters = [];

        // è·å–å¯ç­›é€‰çš„æ•°å€¼åˆ—ï¼ˆæ’é™¤åœ°å€å’Œæ–‡æœ¬åˆ—ï¼‰
        const filterableColumns = columns.filter(c =>
            c.key !== 'address' && c.key !== 'position_bias' && c.key !== 'rank'
        );

        // æ ¼å¼åŒ–å‡½æ•°
        function formatCurrency(value) {
            if (Math.abs(value) >= 1000000) {
                return '$' + (value / 1000000).toFixed(2) + 'M';
            } else if (Math.abs(value) >= 1000) {
                return '$' + value.toLocaleString(undefined, { maximumFractionDigits: 0 });
            } else {
                return '$' + value.toFixed(2);
            }
        }

        function formatHoldTime(days) {
            if (days === 0) return '0';
            if (days >= 1) return days.toFixed(1) + 'å¤©';
            if (days >= 1/24) return (days * 24).toFixed(1) + 'æ—¶';
            return (days * 24 * 60).toFixed(0) + 'åˆ†';
        }

        // æ¸²æŸ“è¡¨å¤´
        function renderHeader() {
            const header = document.getElementById('tableHeader');
            header.innerHTML = '';

            visibleColumns.forEach(key => {
                const col = columns.find(c => c.key === key);
                const th = document.createElement('th');
                th.dataset.key = key;
                th.innerHTML = `${col.label} <span class="sort-icon"></span>`;

                if (currentSort.key === key) {
                    th.classList.add(currentSort.dir === 'asc' ? 'sort-asc' : 'sort-desc');
                }

                th.addEventListener('click', () => sortTable(key));
                header.appendChild(th);
            });
        }

        // æ¸²æŸ“è¡¨æ ¼æ•°æ®
        function renderTable(data) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            data.forEach(row => {
                const tr = document.createElement('tr');

                visibleColumns.forEach(key => {
                    const col = columns.find(c => c.key === key);
                    const td = document.createElement('td');
                    const value = row[key];

                    // æ ¼å¼åŒ–æ˜¾ç¤º
                    td.textContent = col.format(value);

                    // ç‰¹æ®Šæ ·å¼
                    if (col.isAddress) {
                        td.classList.add('address');
                    }

                    if (key === 'rank') {
                        td.classList.add('rank');
                    }

                    // æ ¹æ®å€¼ç€è‰²
                    if (col.colorByValue) {
                        const threshold = col.threshold || 0;
                        if (value > threshold) {
                            td.classList.add('positive', 'highlight');
                        } else if (value < threshold) {
                            td.classList.add('negative');
                        } else {
                            td.classList.add('neutral');
                        }
                    }

                    tr.appendChild(td);
                });

                tbody.appendChild(tr);
            });
        }

        // æ’åºè¡¨æ ¼
        function sortTable(key) {
            if (currentSort.key === key) {
                currentSort.dir = currentSort.dir === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.key = key;
                currentSort.dir = 'desc';
            }

            renderHeader();
            applyFiltersAndRender();
        }

        // æœç´¢è¯
        let searchTerm = '';

        // åº”ç”¨æ‰€æœ‰ç­›é€‰æ¡ä»¶å¹¶è¿”å›æ•°æ®
        function getFilteredData() {
            let data = [...tableData];

            // åº”ç”¨åœ°å€æœç´¢
            if (searchTerm) {
                data = data.filter(row =>
                    row.address.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }

            // åº”ç”¨æ•°å€¼ç­›é€‰
            filters.forEach(filter => {
                data = data.filter(row => {
                    const value = row[filter.column];
                    switch (filter.operator) {
                        case 'gt': return value > filter.value1;
                        case 'gte': return value >= filter.value1;
                        case 'lt': return value < filter.value1;
                        case 'lte': return value <= filter.value1;
                        case 'eq': return value === filter.value1;
                        case 'between': return value >= filter.value1 && value <= filter.value2;
                        default: return true;
                    }
                });
            });

            return data;
        }

        // åº”ç”¨æ’åºå¹¶æ¸²æŸ“
        function applyFiltersAndRender() {
            let data = getFilteredData();

            // åº”ç”¨æ’åº
            data.sort((a, b) => {
                let aVal = a[currentSort.key];
                let bVal = b[currentSort.key];

                if (typeof aVal === 'string') {
                    return currentSort.dir === 'asc'
                        ? aVal.localeCompare(bVal)
                        : bVal.localeCompare(aVal);
                }

                return currentSort.dir === 'asc' ? aVal - bVal : bVal - aVal;
            });

            renderTable(data);
            updateFilterResultCount(data.length);
            renderActiveFilters();
        }

        // æ›´æ–°ç­›é€‰ç»“æœè®¡æ•°
        function updateFilterResultCount(count) {
            const el = document.getElementById('filterResultCount');
            if (filters.length > 0 || searchTerm) {
                el.textContent = `æ˜¾ç¤º ${count} / ${tableData.length} æ¡è®°å½•`;
            } else {
                el.textContent = '';
            }
        }

        // æ¸²æŸ“æ´»åŠ¨ç­›é€‰æ ‡ç­¾
        function renderActiveFilters() {
            const container = document.getElementById('activeFilters');
            container.innerHTML = '';

            filters.forEach((filter, index) => {
                const col = columns.find(c => c.key === filter.column);
                const badge = document.createElement('span');
                badge.className = 'filter-badge';

                let text = col.label + ' ';
                switch (filter.operator) {
                    case 'gt': text += '> ' + filter.value1; break;
                    case 'gte': text += 'â‰¥ ' + filter.value1; break;
                    case 'lt': text += '< ' + filter.value1; break;
                    case 'lte': text += 'â‰¤ ' + filter.value1; break;
                    case 'eq': text += '= ' + filter.value1; break;
                    case 'between': text += filter.value1 + ' ~ ' + filter.value2; break;
                }

                badge.innerHTML = text + ' <span class="filter-badge-remove" data-index="' + index + '">Ã—</span>';
                container.appendChild(badge);
            });

            // ç»‘å®šåˆ é™¤äº‹ä»¶
            container.querySelectorAll('.filter-badge-remove').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const idx = parseInt(e.target.dataset.index);
                    filters.splice(idx, 1);
                    renderFilterList();
                    applyFiltersAndRender();
                });
            });
        }

        // æ¸²æŸ“ç­›é€‰æ¡ä»¶åˆ—è¡¨
        function renderFilterList() {
            const list = document.getElementById('filterList');
            list.innerHTML = '';

            filters.forEach((filter, index) => {
                const row = document.createElement('div');
                row.className = 'filter-row';

                // åˆ—é€‰æ‹©
                const colSelect = document.createElement('select');
                colSelect.className = 'filter-select';
                filterableColumns.forEach(col => {
                    const opt = document.createElement('option');
                    opt.value = col.key;
                    opt.textContent = col.label;
                    opt.selected = col.key === filter.column;
                    colSelect.appendChild(opt);
                });

                // æ“ä½œç¬¦é€‰æ‹©
                const opSelect = document.createElement('select');
                opSelect.className = 'filter-select';
                const operators = [
                    { value: 'gt', label: 'å¤§äº (>)' },
                    { value: 'gte', label: 'å¤§äºç­‰äº (â‰¥)' },
                    { value: 'lt', label: 'å°äº (<)' },
                    { value: 'lte', label: 'å°äºç­‰äº (â‰¤)' },
                    { value: 'eq', label: 'ç­‰äº (=)' },
                    { value: 'between', label: 'åŒºé—´' }
                ];
                operators.forEach(op => {
                    const opt = document.createElement('option');
                    opt.value = op.value;
                    opt.textContent = op.label;
                    opt.selected = op.value === filter.operator;
                    opSelect.appendChild(opt);
                });

                // æ•°å€¼è¾“å…¥1
                const input1 = document.createElement('input');
                input1.type = 'number';
                input1.step = 'any';
                input1.className = 'filter-input';
                input1.placeholder = 'æ•°å€¼';
                input1.value = filter.value1 || '';

                // æ•°å€¼è¾“å…¥2ï¼ˆåŒºé—´ç”¨ï¼‰
                const input2 = document.createElement('input');
                input2.type = 'number';
                input2.step = 'any';
                input2.className = 'filter-input';
                input2.placeholder = 'æœ€å¤§å€¼';
                input2.value = filter.value2 || '';
                input2.style.display = filter.operator === 'between' ? 'block' : 'none';

                // åˆ é™¤æŒ‰é’®
                const removeBtn = document.createElement('button');
                removeBtn.className = 'filter-btn filter-btn-remove';
                removeBtn.textContent = 'Ã—';

                // äº‹ä»¶ç»‘å®š
                colSelect.addEventListener('change', () => {
                    filters[index].column = colSelect.value;
                    applyFiltersAndRender();
                });

                opSelect.addEventListener('change', () => {
                    filters[index].operator = opSelect.value;
                    input2.style.display = opSelect.value === 'between' ? 'block' : 'none';
                    applyFiltersAndRender();
                });

                input1.addEventListener('input', () => {
                    filters[index].value1 = parseFloat(input1.value) || 0;
                    applyFiltersAndRender();
                });

                input2.addEventListener('input', () => {
                    filters[index].value2 = parseFloat(input2.value) || 0;
                    applyFiltersAndRender();
                });

                removeBtn.addEventListener('click', () => {
                    filters.splice(index, 1);
                    renderFilterList();
                    applyFiltersAndRender();
                });

                row.appendChild(colSelect);
                row.appendChild(opSelect);
                row.appendChild(input1);
                row.appendChild(input2);
                row.appendChild(removeBtn);
                list.appendChild(row);
            });
        }

        // æ·»åŠ ç­›é€‰æ¡ä»¶
        function addFilter() {
            filters.push({
                column: filterableColumns[0].key,
                operator: 'gt',
                value1: 0,
                value2: 0
            });
            renderFilterList();
        }

        // æ¸…é™¤æ‰€æœ‰ç­›é€‰
        function clearFilters() {
            filters = [];
            renderFilterList();
            applyFiltersAndRender();
        }

        // åˆ—é€‰æ‹©å™¨
        function renderColumnMenu() {
            const menu = document.getElementById('columnMenu');
            menu.innerHTML = '';

            // æ·»åŠ å…¨é€‰/å–æ¶ˆå…¨é€‰æŒ‰é’®
            const btnContainer = document.createElement('div');
            btnContainer.className = 'column-menu-buttons';

            const selectAllBtn = document.createElement('button');
            selectAllBtn.className = 'column-menu-btn';
            selectAllBtn.textContent = 'å…¨é€‰';
            selectAllBtn.addEventListener('click', () => {
                visibleColumns = columns.map(c => c.key);
                renderHeader();
                sortTable(currentSort.key);
                renderColumnMenu();
            });

            const deselectAllBtn = document.createElement('button');
            deselectAllBtn.className = 'column-menu-btn';
            deselectAllBtn.textContent = 'å–æ¶ˆå…¨é€‰';
            deselectAllBtn.addEventListener('click', () => {
                // ä¿ç•™åŸºç¡€åˆ—ï¼šæ’åå’Œåœ°å€
                visibleColumns = ['rank', 'address'];
                renderHeader();
                sortTable(currentSort.key);
                renderColumnMenu();
            });

            btnContainer.appendChild(selectAllBtn);
            btnContainer.appendChild(deselectAllBtn);
            menu.appendChild(btnContainer);

            // åˆ—å¤é€‰æ¡†
            columns.forEach(col => {
                const label = document.createElement('label');
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = visibleColumns.includes(col.key);
                checkbox.addEventListener('change', () => {
                    if (checkbox.checked) {
                        visibleColumns.push(col.key);
                    } else {
                        visibleColumns = visibleColumns.filter(k => k !== col.key);
                    }
                    // ä¿æŒåŸå§‹é¡ºåº
                    visibleColumns = columns.filter(c => visibleColumns.includes(c.key)).map(c => c.key);
                    renderHeader();
                    sortTable(currentSort.key);
                });

                label.appendChild(checkbox);
                label.appendChild(document.createTextNode(' ' + col.label));
                menu.appendChild(label);
            });
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            renderHeader();
            renderTable(tableData);
            renderColumnMenu();
            renderFilterList();

            // æœç´¢äº‹ä»¶
            document.getElementById('searchInput').addEventListener('input', e => {
                searchTerm = e.target.value;
                applyFiltersAndRender();
            });

            // ç­›é€‰å™¨æŒ‰é’®äº‹ä»¶
            document.getElementById('addFilterBtn').addEventListener('click', addFilter);
            document.getElementById('clearFiltersBtn').addEventListener('click', clearFilters);

            // åˆ—é€‰æ‹©å™¨åˆ‡æ¢
            const toggle = document.getElementById('columnToggle');
            const menu = document.getElementById('columnMenu');

            toggle.addEventListener('click', () => {
                menu.classList.toggle('show');
            });

            document.addEventListener('click', e => {
                if (!toggle.contains(e.target) && !menu.contains(e.target)) {
                    menu.classList.remove('show');
                }
            });
        });
    </script>
</body>
</html>
