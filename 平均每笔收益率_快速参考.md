# 平均每笔收益率 - 快速参考卡片

## 🎯 核心公式

```
单笔收益率 = closedPnL / (|sz| × px)
平均每笔收益率 = Σ(单笔收益率) / 交易笔数
```

## 📊 参数说明

| 参数 | 含义 | 单位 | 示例 |
|-----|------|------|------|
| `closedPnL` | 已实现盈亏 | USD | $500 |
| `sz` | 交易数量 | 币 | 10 或 -10 |
| `px` | 交易价格 | USD | $2,000 |
| `|sz| × px` | 持仓价值 | USD | $20,000 |

## ✅ 核心特点

- ✅ 完全独立，不依赖本金
- ✅ 相对持仓价值计算
- ✅ 不受杠杆影响
- ✅ 可跨策略对比

## 📈 评级标准

| 数值 | 评级 | 说明 |
|------|------|------|
| > 10% | 🟢 极优秀 | 非常高的盈利能力 |
| 5-10% | 🟢 优秀 | 良好的盈利能力 |
| 2-5% | 🟡 中等 | 正期望，可接受 |
| 0-2% | 🟡 偏低 | 盈利能力弱 |
| < 0% | 🔴 负期望 | 长期亏损 |

## 🔍 快速示例

### 例1: 基础计算
```
sz = 10, px = $2,000, closedPnL = $500
持仓价值 = |10| × $2,000 = $20,000
收益率 = $500 / $20,000 = 2.5%
```

### 例2: 做空交易
```
sz = -8, px = $2,500, closedPnL = $400
持仓价值 = |-8| × $2,500 = $20,000
收益率 = $400 / $20,000 = 2.0%
```

### 例3: 多笔平均
```
Trade 1: 3.0%
Trade 2: -1.5%
Trade 3: 4.5%
Trade 4: 2.0%
平均 = (3.0 - 1.5 + 4.5 + 2.0) / 4 = 2.0%
```

## ⚡ 常见误区

❌ **误区 1**: 用总盈亏除以交易次数
```
错误: 平均 = $1,000 / 10 = $100/笔
正确: 平均 = (收益率求和) / 10 = 2.5%
```

❌ **误区 2**: 杠杆会影响收益率
```
错误: 10倍杠杆 → 收益率 × 10
正确: 杠杆不影响（使用持仓价值）
```

❌ **误区 3**: 需要知道本金
```
错误: 需要账本数据计算本金
正确: 每笔交易独立，不需要本金
```

## 🔗 与其他指标关系

```
平均每笔收益率 ─┬─→ Sharpe Ratio
                ├─→ 累计收益率
                └─→ 策略评估
```

### Sharpe Ratio
```
Sharpe = (mean_return - rf) / std_return
```

### 累计收益率
```
累计 = ∏(1 + 单笔收益率) - 1
```

## 💡 优化方向

### 提高收益率
- 优化止盈策略
- 改进入场时机
- 增加持仓时间

### 降低波动
- 严格止损纪律
- 分散交易品种
- 控制仓位大小

## 📱 代码位置

**函数**: `calculate_sharpe_ratio_on_trades()`
**文件**: `apex_fork.py`
**行号**: 1138-1192

## 📚 详细文档

- `平均每笔收益率算法详解.md` - 完整算法说明
- `平均每笔收益率_可视化示例.md` - 图表和示例
- `夏普比率算法详解.md` - Sharpe Ratio 计算

---

**版本**: v1.0 | **更新**: 2026-02-04
